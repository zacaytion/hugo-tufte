$ht-code-border-radius: .4em;

// fix tufte update
pre > code {
    margin-left: 0;
    width: unset;
}

.highlight {
    width: 52.5%;
    margin-left: 2.5%;
    overflow-x: scroll;
    border-radius: $ht-code-border-radius;
    padding: .5em 0 .5em .5em;
    border-left: 3px double #111;

    pre {
        margin: 0;
        width: max-content;
        min-width: 100%;
    }

    &>.chroma>code {
        width: max-content;
    }

    .chroma .hl {
        display: block;
    }

    &::-webkit-scrollbar {
        border-radius: $ht-code-border-radius;
        width: 10px;
        height: 1rem;
    }
    &::-webkit-scrollbar-thumb {
        border-radius: $ht-code-border-radius;
    }
}

@media screen and (max-width: 760px) {
    .highlight {
        width: 90%;
    }
}

// fix #48 => https://github.com/slashformotion/hugo-tufte/issues/48
ul>li>div.highlight {
    width: 100%;
}

@media screen and (prefers-color-scheme: light) {
    $ht-code-bgcolor: #fffff8;
    @import "vendor/chroma-syntax/algo_nu.scss";

    .highlight {
        &::-webkit-scrollbar {
            background: $ht-code-bgcolor;
        }
        &::-webkit-scrollbar-thumb {
            background: scale-color($ht-code-bgcolor, $lightness: -13%, $saturation: -80%);
        }
    }
}

@media screen and (prefers-color-scheme: dark) {

    $ht-code-bgcolor: #151515;
    @import "vendor/chroma-syntax/swapoff.scss";

    .chroma .hl {
        background-color: #d9d9b436;
    }
    .highlight {
        border-color: #a3a3a3;
        &::-webkit-scrollbar {
            background: $ht-code-bgcolor;
        }
        &::-webkit-scrollbar-thumb {
            background: scale-color($ht-code-bgcolor, $lightness: 23%, $saturation: -40%);
        }
    }

    .hl > .lnt {
        color: #ffffff;
    }
}
